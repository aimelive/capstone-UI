<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta name="description" content="Aimelive | Freelance Developer | Official Biography website">
    <meta name="keywords" content="Aimelive, Biography, Awesome websites">
    <meta name="author" content="Aime Ndayambaje">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="titleBar"></title>
    <link rel="icon" href="images/Rectangle 21.png" type="image/x-icon">
    <link rel="stylesheet" href="css/blog.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="script.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

</head>

<body>
    <div class="navbar">
        <table>
            <tr>
                <td><img src="images/Rectangle 21.png" id="logo" width="50px" /></td>
                <td><label id="logo_text">AimeLive</label></td>
            </tr>
        </table>
        <nav class="menu" id="menuBar">
            <a onclick="login_out()" id="admin_login">Login</a>
            <a href="about.html">About</a>
            <a href="contact.html">Contacts</a>
            <a href="blog.html" style="background-color: white;color: black;">News</a>
            <a href="index.html">Home</a>
        </nav>
        <a class="humberg" onclick="showNav()" id="humberg"><i class="fa fa-bars"></i></a>
        <div class="mybodyhover" id="mybodyhover" onclick="closeNav()">
        </div>
        <nav class="mobileNav" id="mobileNav">

            <i style="font-size:24px" class="fa" id="closeNav"><span onclick="closeNav()">&#xf00d;</span></i>
            <a href="#">Home</a>
            <a href="#">News</a>
            <a href="#">About</a>
            <a href="#">Contacts</a>
            <a onclick="login_out()" id="admin_login">Login</a>



        </nav>
    </div>

    <div class="preloader">
        <div class="sk-chase">
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
        </div>
    </div>

    <div class="header">
        <span>Aimelive - Blog Posts ðŸŽ‰ðŸª„  </span>
    </div>
    <div class="subHeader">
        <p><i class="fa fa-link" aria-hidden="true"></i> Quick Links: <a href="#">Personal blog</a> <a href="#"> Projects </a><a href="#">Careers </a><a href="#">Awards</a><a href="#"> Motivations </a>
            <a href="#">View CV </a><a href="#"> Social media links</a> <a href="#"> Contacts</a></p>
    </div>

    <div class="row blog_body">
        <div class="leftcolumn">
            <div class="card">


                <div class="cardimg story">
                    <img id="photo" />

                    <p class="title" id="title"></p>

                    <h5 id="category"></h5>
                    <p id="blogPreview"> </p>
                    <p id="blogBody"> </p>

                    <h5>Posted on, <span id="date"> </span></h5>
                </div>
                <h3>Leave a comment </h3>
                <div class="cardimg" style="height: auto;" id="commentSection">
                    <div class="comment-section" id="comment-section">
                        <div class="comment-container">
                            <div class="profileAvatar">
                                <img src="images/Rectangle 21.png" height="50px" width="50px">
                            </div>
                            <div class="comment-data">
                                <form action="javascript:void(0)" id="com-form" name="commentForm" class="commentForm">
                                    <label for="name">
                                            <input type="text" name="yourName" id="your-name" placeholder="Your name..." required />
                                    </label>
                                    <label for="email">
                                        <input type="email" name="yourEmail" id="your-email" placeholder="Your email..." required />
                                    </label>

                                    <label for="your-comment">
                                            <textarea name="yourComment" id="your-comment" cols="50" rows="10" maxlength="500" placeholder="Your comment..." required></textarea>
                                    </label>

                                    <div id="comment-footer">
                                        <p id="char-indicator"><span id="characters-left">500</span>/500</p>
                                        <button type="submit" id="send-button">Comment</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="rightcolumn">
            <div class="card">
                <h2>About Me</h2>
                <img src="images/IMG-20220113-WA0012-modified.png" class="cardimg" />
                <p>Freelance Developer - Web Specialist - IT Proffesional - Software Management</p>
            </div>
            <div class="card">
                <h3>Popular Post</h3>
                <img src="images/198807056_1350758038653763_5653275032777728992_n.jpg" class="cardimg" />
                <p>Another thing to know about Aimelive is that he hustled for a while since 2018 in journalism media industry, </p>
                <br>
                <img src="images/rwanda-kagame.jpeg" class="cardimg" />
                <p>Another thing to know about Aimelive is that he hustled for a while since 2018 in journalism media industry, </p>
                <br>
                <img src="images/198807056_1350758038653763_5653275032777728992_n.jpg" class="cardimg" />
                <p>Another thing to know about Aimelive is that he hustled for a while since 2018 in journalism media industry, </p>

            </div>
            <div class="card follow">
                <h3>Follow Me</h3>
                <a href="#" class="fa fa-facebook"></a>
                <a href="#" class="fa fa-whatsapp"></a>
                <a href="#" class="fa fa-linkedin"></a>
                <a href="#" class="fa fa-twitter"></a>
                <a href="#" class="fa fa-slack"></a>
                <a href="#" class="fa fa-github"></a>
            </div>
            <div class="newsletter card">
                <div class="main-block">
                    <h1> Stay in touch</h1>
                    <form method="post" name="signupNewsletter" class="subscriptionForm">
                        <center>
                            <img src="images/subscribe-newsletter-icon-30-removebg-preview.png" width="20%" style="margin-bottom: 30px;" />
                        </center>
                        <div class="info">
                            <div class="info-item">
                                <label class="icon" for="lastname"><i class="fa fa-user"></i></label>
                                <input type="text" name="lastname" id="lastname" placeholder="Name" />
                            </div>
                            <div class="info-item2">
                                <label class="icon" for="email"><i class="fa fa-envelope" style="font-size: 15px;"></i></label>
                                <input type="email" name="email" id="email" placeholder="Email" />
                            </div>
                            <h1 style="text-align: center;display: none;" class="h1"> Already a Subscriber! <br> Thanks for subscribing! <br> Enjoy! ðŸŽ‰ðŸª„ <br> <br><br> </h1>
                        </div>
                        <button type="submit" class="subscribeButton">Subscribe</button>
                    </form>

                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p class="label">&copy; Copright; Aimelive 2022 <a href="">Terms and Conditions here</a></p>
    </div>
    <script>
        let status;

        const url = `https://my-brand-aimelive.herokuapp.com/api/v1/blogs/${searchID}`
            //console.log(url);
        fetch(url)
            .then((response) => {
                status = response.status
                return response.json();
            })
            .then((data) => {
                //title.innerHTML = data.Content[12].title
                if (status == 200) {

                    //console.log("READY TO VIEW" + data.Content.blog.title)

                    document.getElementById("titleBar").innerHTML = data.Content.blog.title;
                    document.getElementById("title").innerHTML = data.Content.blog.title;
                    document.getElementById("category").innerHTML = data.Content.blog.category;
                    document.getElementById("blogPreview").innerHTML = data.Content.blog.preview;
                    document.getElementById("blogBody").innerHTML = data.Content.blog.body;
                    document.getElementById("date").innerHTML = new Date().toDateString(data.Content.blog.dateCreated)
                    const image = document.getElementById("photo");
                    image.setAttribute("src", data.Content.blog.imgURL);
                    //console.log("Document data:", doc.data());



                    for (let index = 0; index < data.Content.blog.comments.length; index++) {
                        //console.log(data.Content.blog.comments[index]._id)
                        const id = data.Content.blog.comments[index]._id
                        const username = data.Content.blog.comments[index].name
                        const Comment = data.Content.blog.comments[index].comment
                        const dateC = data.Content.blog.comments[index].dateCreated

                        displayComment(id, username, Comment, dateC);
                    }

                    document.querySelector(".preloader").style.display = "none"

                }
                if (status == 404) {
                    location.href = 'blog.html'
                }

            })

        function displayComment(commentId, name, comment, date) {
            document.getElementById('comment-section').insertAdjacentHTML('beforeend', commentBar(commentId, name, comment, date));
        }
    </script>

    <script src="./js/subscribe.js"></script>
    <script src="server.js"></script>
    <script>
        getuserInfo();

        const comment = document.querySelector(".commentForm")
        async function getuserInfo() {
            response = await fetch("https://my-brand-aimelive.herokuapp.com/api/v1/users/info/user", {
                headers: {
                    "Authorization": token,
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                }
            })

            const user = await response.json()
            console.log("WHY CAN'T I GET THE USER INFO " + user)
            if (response.status == 200) {
                comment.yourName.value = user.Data.name
                comment.yourName.disabled = true
                comment.yourEmail.value = user.Data.email
                comment.yourEmail.disabled = true
            } else {
                comment.yourName.disabled = false
                comment.yourEmail.disabled = false
            }
        }
    </script>
</body>

</html>