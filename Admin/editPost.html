<!DOCTYPE html>
<html>

<head>
    <title>Edit Post - Aimelive </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta name="description" content="Aimelive | Freelance Developer | Official Biography website">
    <meta name="keywords" content="Aimelive, Biography, Awesome websites">
    <meta name="author" content="Aime Ndayambaje">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="Rectangle 21.png" type="image/x-icon">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="./js/script.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script>
        const searchID = location.search.substring(1);
        if (!searchID) {
            location.href = 'news_article.html'
        }
    </script>
    <script src="https://cdn.ckeditor.com/4.18.0/standard/ckeditor.js"></script>

</head>

<body>
    <div class="preloader">
        <div class="sk-chase">
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
        </div>
    </div>
    <div class="header">

        <label id="logo_text">AimeLive</label>
        <div id="styledCard">
            <img src="Rectangle 21.png" onclick="showHidden()" id="styledImage" class="styledImage" />
            <div id="dropDownList" class="dropDown">
                <a href="#"><i class="fa fa-user"></i> &nbsp; Profile</a>
                <a href="#"><i class="fa fa-gear"> </i> &nbsp; Account Settings</a>
                <a href="#"><i class="fa fa-bar-chart"> </i> &nbsp; Analytics</a>
                <a href="#" onclick="logout()"><i class="fa fa-power-off"></i> &nbsp; Log Out</a>
            </div>

        </div>
        <script src="./js/dropdown.js"></script>
    </div>
    <nav class="sidebar">
        <a href="dashboard.html"><i class="fa fa-home"></i> Dashboard </a>
        <a href="faq.html"><i class="fa fa-envelope"></i> Messages</a>
        <a href="news_article.html" style="background-color: white;"><i class="fa fa-newspaper-o"></i> Blogs</a>
        <a href="addPost.html"><i class="fa fa-plus"></i> Add Blog</a>
        <a href="#"><i class="fa fa-bar-chart"></i> Analytics</a>
        <a href="#"> <i class="fa fa-gear"></i> User Account</a>
    </nav>

    <div class="dashboard">
        <div class="addPost">
            <center>
                <img src="../images/images.png" width="50px" style="border-radius: 50%;" />
                <h1>Edit Post <span style="color: #ECB22E;">@Aimelive</span> here </h1>
            </center>
            <form method="post" class="edit-post-to-database">
                <div class="row">
                    <div class="labelClass">
                        <label for="title">Enter a title: </label>
                    </div>
                    <div class="inputClass">
                        <input type="text" id="title" name="title" placeholder="Blog title.." required>
                    </div>
                </div>
                <div class="row">
                    <div class="labelClass">
                        <label for="category">Choose category: </label>
                    </div>
                    <div class="inputClass">
                        <select id="category" name="category" required>
                            <option value="">Select a category</option>
                            <option value="Motivation">Motivation</option>
                            <option value="Careers">Careers</option>
                            <option value="Projects">Projects</option>
                            <option value="Personal blog">Personal blog</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="labelClass">
                        <label for="Preview">Write a preview: </label>
                    </div>
                    <div class="inputClass">
                        <textarea name="preview" id="blogPreview" placeholder="Write a blog preview" style="resize: none;height: 200px;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;" required></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="labelClass">
                        <label for="blog">Write a blog: </label>
                    </div>

                    <div class="inputClass">
                        <textarea name="blog" placeholder="Write a blog..." class="blogBody" required>
                        </textarea>
                        <script>
                            CKEDITOR.replace('blog');
                        </script>

                    </div>
                </div>
                <div class="row" id="imagePreview" style="display: block;">
                    <div class="labelClass">
                        <label for="image">Image Preview: </label>
                    </div>
                    <div class="inputClass" id="outputPreview">
                        <img src="" id="outputImage" height="200px" />
                    </div>
                </div>
                <div class="row">
                    <div class="labelClass">
                        <label for="image">Featured Photo: </label>
                    </div>
                    <div class="inputClass">
                        <input type="file" name="image" onchange="previewFile()" style="resize: none;" id="inputFile" accept="image/*">
                    </div>
                </div>

                <br>
                <div class="row">
                    <input type="submit" value="Post">
                </div>
            </form>


            <script src="./js/editPost.js">
            </script>
        </div>

    </div>


    <script>
        let status;

        const blog2 = document.querySelector(".blogBody")
        const url = `https://my-brand-aimelive.herokuapp.com/api/v1/blogs/${searchID}`
            //console.log(url);
        fetch(url)
            .then((response) => {
                status = response.status
                return response.json();
            })
            .then((data) => {

                if (status == 200) {

                    document.getElementById("title").value = data.Content.blog.title;
                    document.getElementById("category").value = data.Content.blog.category;
                    document.getElementById("blogPreview").value = data.Content.blog.preview;
                    //blog2.value = data.Content.blog.body;
                    CKEDITOR.instances['blog2'].setData(data.Content.blog.body)
                    const image = document.getElementById("outputImage");
                    image.setAttribute("src", data.Content.blog.imgURL);

                }
                if (status == 404) {
                    //console.log("Blog not found!!!")
                    swal('error', '(404) ' + data.Error, 'error').then(() => {
                        location.href = 'news_article.html'
                    })
                }

            })
    </script>
    <script src="js/logout.js"></script>
</body>

</html>