<!DOCTYPE html>
<html>

<head>
    <title>Messages & Queries - Aimelive </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta name="description" content="Aimelive | Freelance Developer | Official Biography website">
    <meta name="keywords" content="Aimelive, Biography, Awesome websites">
    <meta name="author" content="Aime Ndayambaje">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="Rectangle 21.png" type="image/x-icon">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="./js/script.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

</head>

<body>
    <div class="header">
        <label id="logo_text">AimeLive</label>
        <div id="styledCard">
            <img src="Rectangle 21.png" onclick="showHidden()" id="styledImage" class="styledImage" />
            <div id="dropDownList" class="dropDown">
                <a href="#"><i class="fa fa-user"></i> &nbsp; Profile</a>
                <a href="#"><i class="fa fa-gear"> </i> &nbsp; Account Settings</a>
                <a href="#"><i class="fa fa-bar-chart"> </i> &nbsp; Analytics</a>
                <a href="#"><i class="fa fa-power-off"></i> &nbsp; Log Out</a>
            </div>

        </div>
        <script src="./js/dropdown.js"></script>
    </div>
    <nav class="sidebar">
        <a href="dashboard.html"><i class="fa fa-home"></i> Home</a>
        <a href="#" style="background-color: white;"><i class="fa fa-envelope"></i> Messages</a>
        <a href="news_article.html"><i class="fa fa-newspaper-o"></i> Articles</a>
        <a href="comments.html"><i class="fa fa-comments-o"></i> Comments</a>
        <a href="#"><i class="fa fa-bar-chart"></i> Analytics</a>
        <a href="#"> <i class="fa fa-gear"></i> Account Settings</a>
    </nav>
    <script src="./js/getAllMessages.js"></script>

    <div id="myModal" class="showModal">
        <div class="modalContent">
            <span class="close" onclick="closeModal()">&times;</span>
            <img src="Rectangle 21.png" />
            <h2> Delete Message </h2>
            <p>Are you sure do you want to delete this message? <br> ðŸ‘‡ </p>
            <div class="messageBox">
                <span class="com-o"> <i class="fa fa-comments-o"></i> </span> <span class="com-o" style="float: right;"> <i class="fa fa-comments-o"></i> </span>
                <p class="divMessage"> Hey Aime, I love you so much!!! Hey Aime, I love you so much!!! Hey Aime, I love you so much!!! Hey Aime, I love you so much!!! Hey Aime, I love you so much!!!</p>
                <span class="com-o"> <i class="fa fa-comments-o"></i> </span> <span class="com-o" style="float: right;"> <i class="fa fa-comments-o"></i> </span>
            </div>
            <p> <span class="divName"> NIYONSHUTI Frederick </span> ( <a href="#"><span class="divEmail">niyonshutipatricie@gmail.com </span></a>) </p>
            <div class="clearfix">
                <button type="button" class="replybtn" style="background-color: #3299F9;">Reply</button>
                <button type="button" class="cancelbtn" onclick="closeModal()">Cancel</button>
                <button type="button" class="deletebtn">Delete</button>
            </div>
        </div>


    </div>

    <script>
        let messageId;
        var modal = document.querySelector(".showModal")
        var divEmail = document.querySelector(".divEmail")
        var divName = document.querySelector(".divName")
        var divMessage = document.querySelector(".divMessage")
        var deletebtn = document.querySelector(".deletebtn")

        function showModal(msgId, message, name, email) {
            messageId = msgId
            divEmail.innerHTML = email
            divName.innerHTML = name
            divMessage.innerHTML = message
            modal.style.display = "block"


        }


        // function deleteComment() {
        //     console.log(messageId)

        // }
        deletebtn.addEventListener('click', async(e) => {
            e.preventDefault()
            console.log(messageId)
            try {
                const resp = await fetch('https://my-brand-aimelive.herokuapp.com/api/v1/messages/' + messageId, {
                    method: 'DELETE',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': token
                    },
                })

                const data = await resp.json()
                    //console.log(resp)
                if (resp.status == 202) {
                    swal('success', data.Message, 'success').then(() => {
                        location.reload()

                    })

                }
                //const data = await resp.json()

                if (resp.status == 404) {
                    swal('error', data.Message, 'error')
                }
                if (resp.status == 400) {
                    swal('error', data.Message, 'error')
                }



            } catch (error) {
                console.log("AN ERROR OCCURED HERE IN THIS CATCH " + error)
            }

        })

        function closeModal() {
            modal.style.display = "none"
        }
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
    <div class="dashboard">
        <h1>Overview </h1>
        <div id="overviewCard">
            <div id="dashCard">
                <i class="fa fa-newspaper-o"></i>
                <h2 class="totalMessages">0</h2>
                <span>Total Messages </span>
            </div>
            <div id="dashCard" style="color:#2EB67D;border-color:#2EB67D">
                <i class="fa fa-comments-o"></i>
                <h2>0</h2>
                <span>Answered</span>
            </div>
            <div id="dashCard" style="color:#3299F9;border-color:#3299F9">
                <i class="fa fa-envelope"></i>
                <h2>0</h2>
                <span>New messages</span>
            </div>
            <div id="dashCard" style="color:#EA6767;border-color:#EA6767">
                <i class="fa fa-edit"></i>
                <h2>0</h2>
                <span>Unanswered </span>
            </div>
        </div>
        <h1>Recently Messages </h1>

        <div id="getM">

        </div>
        <center>
            <a style="color: #3299F9;text-decoration: underline;cursor: pointer;"> View answered queries </a>&nbsp;&nbsp;&nbsp;
            <a style="color: #EA6767;text-decoration: underline; cursor: pointer;"> View unanswered queries </a>
        </center>
    </div>
</body>

</html>